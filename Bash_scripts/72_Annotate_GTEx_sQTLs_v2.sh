#!/bin/bash

MASTER_ROUTE=$1
analysis=$2


Rscripts_path=$(echo "/home/manuel.tardaguila/Scripts/R/")
module load R/4.1.0


bashrc_file=$(echo "/home/manuel.tardaguila/.bashrc")

source $bashrc_file
eval "$(conda shell.bash hook)"


output_dir=$(echo "$MASTER_ROUTE""/""$analysis""/")

#rm -rf $output_dir
#mkdir -p $output_dir

#GTEx_sQTLs

Log_files=$(echo "$output_dir""Log_files""/")

# rm -rf $Log_files
# mkdir -p $Log_files


# #### get_vcf #############################


# type=$(echo "get_vcf")
# outfile_get_vcf=$(echo "$Log_files""outfile_1_""$type"".log")
# touch $outfile_get_vcf
# echo -n "" > $outfile_get_vcf
# name_get_vcf=$(echo "$type""_job")
# seff_name=$(echo "seff""_""$type")

# Rscript_get_vcf=$(echo "$Rscripts_path""229_Read_variant_files_GTex_sQTLs.R")


# Tissue_oI=$(echo 'Whole_Blood')
# sQTL_genes_array=$(echo 'ANK1,ATL1,EEFSEC,KDSR,MFSD2B,PLCL2,RASAL3,TAF8,EVI5,NPRL3,FOXP1,PRMT5_AS1,PILRB,ARSA,ODF3B,VMP1,ELP5,SLC11A1,GFI1B')

# myjobid_get_vcf=$(sbatch --job-name=$name_get_vcf --output=$outfile_get_vcf --partition=cpuq --time=24:00:00 --nodes=1 --ntasks-per-node=1 --mem-per-cpu=4096M --parsable --wrap="Rscript $Rscript_get_vcf --sQTL_genes_array $sQTL_genes_array --Tissue_oI $Tissue_oI --type $type --out $output_dir")
# myjobid_seff_get_vcf=$(sbatch --dependency=afterany:$myjobid_get_vcf --open-mode=append --output=$outfile_get_vcf --job-name=$seff_name --partition=cpuq --time=24:00:00 --nodes=1 --ntasks-per-node=1 --mem-per-cpu=128M --parsable --wrap="seff $myjobid_get_vcf >> $outfile_get_vcf")

# ##### run_LDlinkR  #############################

# conda activate renv_latest

# type=$(echo "run_LDlinkR")
# outfile_run_LDlinkR=$(echo "$Log_files""outfile_2_""$type"".log")
# touch $outfile_run_LDlinkR
# echo -n "" > $outfile_run_LDlinkR
# name_run_LDlinkR=$(echo "$type""_job")
# seff_name=$(echo "seff""_""$type")

# Rscript_run_LDlinkR=$(echo "$Rscripts_path""232_run_LDlinkR.R")

# VAR_array=$(echo 'chr7_99970285_C_T,chr7_99969832_C_T,chr7_99968784_G_A,chr7_99966338_G_A,chr7_99965948_C_A,chr7_99965219_G_A,chr7_99965201_A_AC,chr7_99964705_T_C,chr7_99964635_C_T,chr7_99964532_C_A,chr7_99963925_T_C,chr7_99963243_G_C,chr7_99959594_T_C,chr7_99933880_G_A,chr7_99926170_C_CA,chr7_99900334_T_A,chr7_99876804_A_G,chr7_99856859_G_A,chr7_99855206_G_A,chr7_99714378_C_T,chr7_99709876_C_T,chr7_99697392_C_T,chr7_99679433_A_G,chr7_99645210_C_T,chr7_99616586_A_G,chr7_99607487_G_A,chr7_100641897_C_G,chr7_100636069_C_T,chr7_100592493_T_C,chr7_100589726_T_A,chr7_100588465_T_A,chr7_100587942_C_T,chr7_100586138_C_T,chr7_100577850_T_C,chr7_100576127_G_A,chr7_100566366_C_T,chr7_100561944_A_G,chr7_100550845_T_C,chr7_100543824_A_G,chr7_100537297_C_A,chr7_100532321_A_G,chr7_100530491_G_A,chr7_100523647_G_A,chr7_100522864_T_C,chr7_100514153_C_T,chr7_100513696_T_C,chr7_100513442_A_G,chr7_100512701_C_T,chr7_100509876_A_G,chr7_100506745_C_T,chr7_100504025_G_T,chr7_100501843_T_C,chr7_100501057_C_G,chr7_100500673_C_T,chr7_100500672_C_T,chr7_100500272_C_T,chr7_100499119_G_T,chr7_100498041_C_T,chr7_100497726_C_G,chr7_100494754_T_TA,chr7_100494688_A_G,chr7_100494432_A_G,chr7_100494172_T_C,chr7_100493592_G_A,chr7_100492426_T_C,chr7_100491762_A_G,chr7_100491394_C_T,chr7_100491017_C_G,chr7_100486481_C_T,chr7_100486301_G_A,chr7_100485455_G_A,chr7_100484321_G_A,chr7_100483683_C_T,chr7_100483563_G_A,chr7_100483426_C_T,chr7_100483115_A_G,chr7_100482851_A_T,chr7_100482234_A_T,chr7_100481131_C_T,chr7_100480603_G_A,chr7_100479650_A_G,chr7_100478991_A_G,chr7_100476397_G_A,chr7_100475669_A_G,chr7_100475446_G_C,chr7_100475144_C_T,chr7_100474408_T_C,chr7_100473135_T_C,chr7_100472080_T_C,chr7_100471465_T_C,chr7_100471313_T_C,chr7_100469649_G_A,chr7_100467820_A_T,chr7_100467096_A_G,chr7_100466296_G_GT,chr7_100464450_T_TC,chr7_100462502_C_T,chr7_100461240_C_T,chr7_100458597_T_C,chr7_100458543_C_T,chr7_100457014_GT_G,chr7_100456067_T_C,chr7_100452119_A_G,chr7_100448881_A_G,chr7_100448262_A_G,chr7_100447131_A_G,chr7_100446928_T_C,chr7_100446188_CCCA_C,chr7_100445550_A_G,chr7_100445432_G_A,chr7_100444790_T_C,chr7_100442347_C_T,chr7_100442192_C_T,chr7_100441322_C_T,chr7_100440067_T_C,chr7_100438604_TAGG_T,chr7_100435042_G_A,chr7_100434665_T_C,chr7_100434135_G_T,chr7_100433989_G_A,chr7_100433879_C_CCTATTCTCTAGCCCTT,chr7_100430861_T_C,chr7_100430564_C_T,chr7_100429716_C_G,chr7_100429157_G_C,chr7_100428792_T_TCA,chr7_100427941_T_C,chr7_100427722_A_T,chr7_100426530_T_C,chr7_100426215_C_T,chr7_100425685_C_T,chr7_100423995_A_C,chr7_100423359_G_A,chr7_100421281_G_A,chr7_100419831_G_A,chr7_100419221_C_G,chr7_100418731_A_C,chr7_100417501_A_G,chr7_100417223_C_T,chr7_100416690_G_A,chr7_100415834_T_C,chr7_100414956_A_C,chr7_100414711_G_A,chr7_100412371_T_C,chr7_100412362_C_G,chr7_100411599_TG_T,chr7_100411251_G_GA,chr7_100410647_T_C,chr7_100408870_G_A,chr7_100408097_C_T,chr7_100406954_G_C,chr7_100406920_T_C,chr7_100406823_C_T,chr7_100405149_A_G,chr7_100403318_C_T,chr7_100402651_C_A,chr7_100400984_G_A,chr7_100397190_A_G,chr7_100397162_G_A,chr7_100393925_C_T,chr7_100392741_T_G,chr7_100390780_A_G,chr7_100390182_C_T,chr7_100386466_T_C,chr7_100385512_C_T,chr7_100384272_T_C,chr7_100384236_G_C,chr7_100384152_A_G,chr7_100382481_T_C,chr7_100381941_C_G,chr7_100379959_T_G,chr7_100379080_G_A,chr7_100377643_A_G,chr7_100377345_G_A,chr7_100375779_G_A,chr7_100375728_C_T,chr7_100375724_T_G,chr7_100374780_C_T,chr7_100374499_A_G,chr7_100374211_A_G,chr7_100373690_T_C,chr7_100372565_C_T,chr7_100370866_A_ACT,chr7_100370114_C_T,chr7_100370021_G_A,chr7_100367705_GA_G,chr7_100367662_T_C,chr7_100367166_T_G,chr7_100367038_A_G,chr7_100364473_T_C,chr7_100363571_A_G,chr7_100360371_GGA_G,chr7_100359505_GCCT_G,chr7_100359270_A_T,chr7_100358667_C_G,chr7_100358243_G_A,chr7_100357741_G_A,chr7_100356834_G_T,chr7_100356770_G_A,chr7_100355347_A_G,chr7_100355205_C_T,chr7_100353692_A_G,chr7_100352885_G_C,chr7_100352827_G_A,chr7_100352804_G_T,chr7_100352795_T_TGC,chr7_100352792_TCA_T,chr7_100352785_A_G,chr7_100352674_A_T,chr7_100350351_G_A,chr7_100350034_C_G,chr7_100348762_C_G,chr7_100345960_A_T,chr7_100345660_A_G,chr7_100343007_A_C,chr7_100341698_C_T,chr7_100341332_G_A,chr7_100341241_G_A,chr7_100340860_C_T,chr7_100340582_T_G,chr7_100340319_A_G,chr7_100340318_A_G,chr7_100340180_A_G,chr7_100339858_A_G,chr7_100337474_G_A,chr7_100336569_T_C,chr7_100336385_T_G,chr7_100334426_C_T,chr7_100332824_C_T,chr7_100329188_C_T,chr7_100328899_A_G,chr7_100328685_T_C,chr7_100327588_C_T,chr7_100324770_T_C,chr7_100319793_G_A,chr7_100315523_G_T,chr7_100308677_C_T,chr7_100308061_A_G,chr7_100307852_C_G,chr7_100307835_G_A,chr7_100307702_C_T,chr7_100307346_A_G,chr7_100305561_A_G,chr7_100300833_C_A,chr7_100299852_C_T,chr7_100297686_C_G,chr7_100296318_T_TG,chr7_100296142_C_T,chr7_100295525_C_G,chr7_100294394_AG_A,chr7_100291556_G_A,chr7_100288886_G_A,chr7_100285505_T_G,chr7_100285503_C_T,chr7_100282865_G_C,chr7_100282394_G_A,chr7_100280683_T_C,chr7_100276574_T_A,chr7_100276155_A_C,chr7_100274448_T_C,chr7_100274184_G_A,chr7_100272055_G_C,chr7_100265861_A_G,chr7_100263526_C_T,chr7_100262951_G_A,chr7_100260882_C_T,chr7_100256447_C_T,chr7_100253646_T_A,chr7_100252231_G_A,chr7_100250355_A_G,chr7_100249614_C_T,chr7_100249524_T_G,chr7_100249195_GCA_G,chr7_100249191_T_TGG,chr7_100248791_T_C,chr7_100242838_A_G,chr7_100239062_G_T,chr7_100236567_T_C,chr7_100233495_G_C,chr7_100232463_C_T,chr7_100230318_C_T,chr7_100229525_T_C,chr7_100228125_A_G,chr7_100227935_G_A,chr7_100227652_A_G,chr7_100226830_A_G,chr7_100225998_A_G,chr7_100225899_C_T,chr7_100224062_C_T,chr7_100223847_A_G,chr7_100223758_C_G,chr7_100223254_A_G,chr7_100222427_T_C,chr7_100222221_G_A,chr7_100221954_G_A,chr7_100221381_CTCTG_C,chr7_100221304_C_T,chr7_100220236_A_G,chr7_100219962_G_T,chr7_100219768_A_G,chr7_100218814_G_A,chr7_100218652_G_C,chr7_100218649_A_G,chr7_100218633_C_A,chr7_100218556_T_C,chr7_100218293_TAA_T,chr7_100217868_A_C,chr7_100216289_G_A,chr7_100216049_T_C,chr7_100215662_C_A,chr7_100215012_TCAGA_T,chr7_100214385_G_A,chr7_100213690_G_A,chr7_100213379_T_C,chr7_100213020_T_G,chr7_100212802_A_G,chr7_100212490_T_C,chr7_100211409_C_T,chr7_100210033_G_C,chr7_100209523_C_G,chr7_100205189_G_C,chr7_100204421_C_T,chr7_100203335_G_A,chr7_100202936_G_T,chr7_100198298_GAGGGGGTAAT_G,chr7_100195043_A_G,chr7_100194926_G_GA,chr7_100193916_T_C,chr7_100193348_G_A,chr7_100193054_A_G,chr7_100192194_T_C,chr7_100189749_A_G,chr7_100189341_G_T,chr7_100189196_C_T,chr7_100188142_T_G,chr7_100188048_A_G,chr7_100187820_G_A,chr7_100187081_G_T,chr7_100186091_G_T,chr7_100185130_C_G,chr7_100184687_C_T,chr7_100182660_G_A,chr7_100182659_C_G,chr7_100182263_G_A,chr7_100181636_T_C,chr7_100181620_A_G,chr7_100180662_A_C,chr7_100180604_G_T,chr7_100179799_G_A,chr7_100179185_G_A,chr7_100179045_G_A,chr7_100178649_T_C,chr7_100178060_C_CAGTG,chr7_100176499_T_C,chr7_100174226_A_G,chr7_100171334_C_T,chr7_100154943_G_A,chr7_100146949_T_C,chr7_100139389_G_A,chr7_100132578_C_T,chr7_100122130_G_A,chr7_100101813_G_A,chr7_100097403_G_A,chr7_100095455_G_A,chr7_100095370_G_T,chr7_100092644_CTA_C,chr7_100089250_G_T,chr7_100080868_A_G,chr7_100076663_G_A,chr7_100075736_A_C,chr7_100072705_A_T,chr7_100072482_G_T,chr7_100070484_G_T,chr7_100069018_G_C,chr7_100068175_C_T,chr7_100065893_A_G,chr7_100065123_C_CTT,chr7_100062525_G_A,chr7_100058940_C_G,chr7_100057066_G_A,chr7_100056977_A_G,chr7_100055938_G_A,chr7_100055299_C_G,chr7_100053760_A_G,chr7_100053744_C_G,chr7_100052694_T_C,chr7_100051532_G_A,chr7_100051336_T_C,chr7_100050983_G_A,chr7_100048610_CTAT_C,chr7_100045258_T_C,chr7_100043484_ATCC_A,chr7_100041777_C_T,chr7_100041564_G_A,chr7_100040221_G_T,chr7_100038344_G_A,chr7_100036116_G_C,chr7_100035359_T_C,chr8_41845092_C_T,chr8_41844838_G_C,chr8_41839560_T_G,chr8_41839126_C_A,chr8_41838804_C_T,chr8_41838586_T_C,chr8_41837403_G_A,chr8_41836250_T_A,chr8_41835907_T_G,chr8_41835695_T_G,chr8_41835341_C_A,chr8_41834578_G_C,chr8_41834556_C_T,chr8_41834067_T_C,chr8_41833214_C_G,chr8_41830529_T_C,chr8_41828499_C_T,chr8_41828327_T_G,chr8_41828296_A_C,chr8_41827572_C_T,chr8_41827352_T_G,chr8_41826970_A_C,chr8_41826106_C_G,chr8_41824417_T_C,chr8_41823336_A_G,chr8_41822037_G_A,chr8_41820609_G_C,chr8_41820185_G_C,chr8_41817007_G_A,chr8_41815573_G_C,chr8_41814935_T_C,chr8_41813985_A_G,chr8_41812301_T_A,chr8_41811184_A_G,chr8_41809356_T_C,chr8_41808837_G_T,chr8_41808436_G_A,chr8_41806628_C_T,chr8_41804901_A_T,chr8_41804738_C_G,chr8_41804495_A_G,chr8_41804419_A_G,chr8_41804198_T_C,chr8_41804014_A_G,chr8_41802153_C_T,chr8_41799321_G_T,chr8_41796022_T_G,chr8_41793950_T_C,chr8_41791768_C_T,chr8_41790840_G_A,chr8_41789222_G_A,chr8_41789165_A_C,chr8_41788503_A_G,chr8_41785993_C_T,chr8_41785368_A_G,chr8_41784598_T_A,chr8_41784416_T_C,chr8_41784106_G_A,chr8_41783875_C_T,chr8_41783633_T_C,chr8_41783557_C_T,chr8_41783388_C_T,chr8_41783139_G_A,chr8_41783128_G_C,chr8_41782607_C_T,chr8_41781722_G_A,chr8_41781455_C_T,chr8_41779968_G_A,chr8_41779854_G_C,chr8_41779842_C_T,chr8_41779806_G_A,chr8_41779637_AT_A,chr8_41778886_G_T,chr8_41778553_C_T,chr8_41778493_A_G,chr8_41778484_T_A,chr8_41777497_C_T,chr8_41775980_C_A,chr8_41775802_G_A,chr8_41774412_A_C,chr8_41774315_G_A,chr8_41774244_T_C,chr8_41773414_G_T,chr8_41772565_T_C,chr8_41770131_A_G,chr8_41766587_C_T,chr8_41765431_G_A,chr8_41764385_C_T,chr8_41764110_G_A,chr8_41763627_A_G,chr8_41762594_A_G,chr8_41760977_TGAA_T,chr8_41760309_C_T,chr8_41760017_C_T,chr8_41759431_G_A,chr8_41759361_C_A,chr8_41759010_C_G,chr8_41758960_G_A,chr8_41757620_G_A,chr8_41756985_G_A,chr8_41756769_G_C,chr8_41756740_A_C,chr8_41756738_G_A,chr8_41755542_T_G,chr8_41752976_A_C,chr8_41752925_C_T,chr8_41749761_C_T,chr8_41735102_T_C,chr6_42069890_C_G,chr6_42069610_T_C,chr6_42069429_C_T,chr6_42063140_C_G,chr6_42062907_G_T,chr6_42062168_G_A,chr6_42062128_A_G,chr6_42061533_C_A,chr6_42060492_G_A,chr6_42057807_A_C,chr6_42057580_G_A,chr6_42056896_G_A,chr6_42056547_G_A,chr6_42055880_A_ATAC,chr6_42055207_C_T,chr6_42055077_C_T,chr6_42054825_T_C,chr6_42054549_G_A,chr6_42051884_T_G,chr6_42049583_T_C,chr6_42049548_T_C,chr6_42049058_T_C,chr6_42048508_T_C,chr6_42048148_C_T,chr6_42046319_T_C,chr6_42046211_G_A,chr6_42045304_C_T,chr2_24174047_G_A,chr2_24169177_C_T,chr2_24151534_C_T,chr2_24073546_G_A,chr2_24033201_T_C,chr2_24025604_G_A,chr2_24024816_C_T,chr2_24022297_G_A,chr2_24021733_G_A,chr2_24021447_G_A,chr2_24021167_G_A,chr2_24019762_C_T,chr2_24018699_A_T,chr2_24017030_CTGAAGTG_C,chr2_24015241_G_A,chr2_24002619_T_A,chr2_23998785_G_A,chr2_23961376_G_A,chr2_23948819_G_A,chr2_23793655_A_G,chr2_23791148_T_C,chr2_23775462_T_G,chr2_23732515_A_C,chr2_23715501_G_A,chr2_23714530_G_A,chr2_23713095_C_T,chr2_23712076_T_A,chr2_23707256_G_A,chr2_23704627_C_T,chr2_23702867_CAAGGGTAGGACTGAGCTGGATAGAGAGGAGGGGAGCACTGTGTG_C,chr2_23701530_T_C,chr2_23700245_G_A,chr2_23697709_T_TATC,chr2_23697360_C_A,chr2_23696969_CG_C,chr2_23696687_G_A,chr2_23696337_G_A,chr2_23696021_C_T,chr2_23693735_C_T,chr2_23687909_C_T,chr2_23685093_C_T,chr2_23684809_C_T,chr2_23683681_G_C,chr2_23683527_G_T,chr2_23682680_A_G,chr2_23682661_C_T,chr2_23681833_G_A,chr2_23680942_C_T,chr2_23680525_A_G,chr2_23680512_G_A,chr2_23680483_G_A,chr2_23680215_A_C,chr2_23679444_T_C,chr2_23679259_GCAGTTTGGACTA_G,chr2_23678896_G_A,chr2_23677758_G_A,chr2_23675299_A_G,chr2_23674385_T_C,chr2_23672728_C_A,chr2_23672237_C_T,chr19_15456089_G_A,chr22_50672096_C_G,chr22_50640119_TG_T,chr22_50639828_CA_C,chr22_50637765_G_C,chr22_50635146_G_T,chr22_50635033_T_C,chr22_50632939_C_T,chr22_50632850_G_T,chr22_50631857_T_C,chr22_50631729_C_G,chr22_50630387_A_C,chr22_50630323_C_T,chr22_50630132_G_A,chr22_50630089_C_G,chr22_50628562_C_T,chr22_50628493_G_A,chr22_50626933_C_A,chr22_50626390_T_C,chr22_50625713_G_A,chr22_50625611_G_C,chr22_50625559_G_C,chr22_50624805_A_T,chr22_50624463_C_G,chr22_50624290_C_T,chr22_50624226_T_C,chr22_50623794_G_C,chr22_50620690_G_T,chr22_50619782_C_G,chr22_50619495_C_T,chr22_50619476_T_G,chr22_50619474_T_C,chr22_50619153_A_G,chr22_50618683_A_G,chr22_50617472_C_T,chr22_50616038_C_T,chr22_50615836_T_C,chr22_50615462_ACT_A,chr22_50615291_T_C,chr22_50614718_C_A,chr22_50614679_C_T,chr22_50614642_T_C,chr22_50613951_T_C,chr22_50610384_G_C,chr22_50610353_T_G,chr22_50609631_A_G,chr22_50609505_A_G,chr22_50608813_T_C,chr22_50608790_G_A,chr22_50607735_C_T,chr22_50607668_A_G,chr22_50607388_A_G,chr22_50607316_C_G,chr22_50607052_G_A,chr22_50607005_C_T,chr22_50606762_C_T,chr22_50606381_G_GCCA,chr22_50606376_G_T,chr22_50606374_C_CTCCCTCAAGCTT,chr22_50606372_G_A,chr22_50606369_C_CTGCATCTG,chr22_50604850_G_A,chr22_50604055_C_T,chr22_50602117_C_T,chr22_50601349_C_A,chr22_50601339_T_A,chr22_50599883_C_T,chr22_50598205_A_G,chr22_50597592_A_G,chr22_50596532_C_T,chr22_50596441_A_G,chr22_50596438_T_C,chr22_50595748_G_A,chr22_50595411_C_G,chr22_50592780_G_C,chr22_50592320_A_G,chr22_50589826_C_T,chr22_50589634_C_CAAACA,chr22_50587170_C_A,chr22_50587166_C_G,chr22_50586645_C_T,chr22_50586408_G_A,chr22_50586195_T_C,chr22_50585879_T_C,chr22_50585495_C_T,chr22_50584995_T_C,chr22_50584433_A_G,chr22_50584090_C_T,chr22_50583688_C_A,chr22_50583170_C_T,chr22_50583150_A_C,chr22_50582239_C_A,chr22_50580150_A_G,chr22_50578653_T_A,chr22_50577052_G_A,chr22_50576781_G_C,chr22_50573507_T_C,chr22_50572359_T_A,chr22_50571524_C_T,chr22_50565992_G_A,chr22_50565942_G_A,chr22_50565919_T_C,chr22_50565675_C_T,chr22_50565624_T_C,chr22_50565407_A_G,chr22_50563409_C_T,chr22_50563003_G_C,chr22_50562965_T_G,chr22_50560753_C_T,chr22_50560554_A_AT,chr22_50560544_A_C,chr22_50558252_A_C,chr22_50557737_A_ATGT,chr22_50556074_T_C,chr22_50555378_T_C,chr22_50555369_G_C,chr22_50555126_T_TAAATAAATAAATAAAAATTTAA,chr22_50554991_G_A,chr22_50554796_T_C,chr22_50554538_A_G,chr22_50553803_A_G,chr22_50553668_C_T,chr22_50552604_C_T,chr22_50550897_A_G,chr22_50549764_A_G,chr22_50549633_G_T,chr22_50547274_A_G,chr22_50545987_CTGGTGGGGT_C,chr22_50545574_A_G,chr22_50544028_G_A,chr22_50543513_C_T,chr22_50537324_G_A,chr22_50536106_G_A,chr22_50533425_G_A,chr22_50521179_C_T,chr22_50519963_C_T,chr2_219272861_T_G,chr2_219253368_T_G,chr2_219100960_C_T,chr2_218649059_T_C,chr2_218566568_G_A,chr2_218407571_G_T,chr2_218403190_A_G,chr2_218403058_C_T,chr2_218401700_C_A,chr2_218401481_T_C,chr2_218399384_G_A,chr2_218397456_G_C,chr2_218396453_C_T,chr2_218395928_C_A,chr2_218395308_G_A,chr2_218395295_A_AAAAC,chr2_218395121_A_G,chr2_218394547_G_A,chr2_218390718_C_T,chr2_218390700_A_G,chr2_218390157_A_AT,chr2_218390119_T_C,chr2_218387654_C_T,chr2_218385280_G_C,chr2_218385048_C_G,chr2_218384290_C_T,chr2_218378139_T_C,chr2_218374434_A_G,chr2_218374365_G_C,chr2_218373478_T_C,chr2_218373476_A_C,chr2_218372614_G_T,chr2_218369982_T_C,chr2_218369616_G_T,chr2_218369567_T_A,chr2_218368729_A_G,chr2_218367631_C_A,chr2_218366289_A_G,chr2_218365119_A_G,chr2_218364918_T_C,chr2_218364424_G_A,chr2_218364360_A_AC,chr2_218363033_T_C,chr2_218360222_G_A,chr2_218358943_G_A,chr2_218357400_C_T,chr2_218357123_G_A,chr2_218356632_A_T,chr2_218355117_G_A,chr2_218354349_C_T,chr2_218353884_AT_A,chr2_218352580_A_G,chr2_218352170_C_A,chr2_218351646_A_C,chr2_218350485_T_C,chr2_218349917_A_C,chr2_218347281_G_T,chr2_218346058_G_A,chr2_218345883_T_C,chr2_218345073_C_A,chr2_218342196_C_T,chr2_218338355_G_T,chr2_218337901_C_T,chr2_218337761_G_A,chr2_218336944_C_T,chr2_218333700_A_T,chr2_218333302_C_T,chr2_218331621_T_C,chr2_218331076_G_A,chr2_218329240_C_T,chr2_218328902_C_CTG,chr2_218328032_G_A,chr2_218326846_G_A,chr2_218326533_T_C,chr2_218324931_G_A,chr2_218324165_G_GCA,chr2_218324115_C_T,chr2_218323854_C_T,chr2_218323178_C_T,chr2_218323017_C_T,chr2_218322975_G_A,chr2_218322880_C_A,chr2_218322644_T_C,chr2_218321869_G_A,chr2_218321739_T_C,chr2_218321126_G_GCTTGAGCA,chr2_218320822_A_G,chr2_218320438_C_T,chr2_218320310_G_T,chr2_218320149_G_T,chr2_218319998_T_C,chr2_218319968_A_G,chr2_218319894_G_A,chr2_218319769_A_G,chr2_218319713_C_T,chr2_218319709_C_T,chr2_218319707_A_C,chr2_218319675_C_T,chr2_218319664_G_A,chr2_218319578_A_G,chr2_218319565_A_G,chr2_218319552_C_T,chr2_218319476_A_G,chr2_218319444_C_T,chr2_218318330_GC_G,chr2_218318025_T_C,chr2_218317758_G_A,chr2_218315272_G_A,chr2_218314932_CA_C,chr2_218314152_G_A,chr2_218313344_C_T,chr2_218312425_C_T,chr2_218312172_C_A,chr2_218311727_A_C,chr2_218310764_A_G,chr2_218308119_CA_C,chr2_218306468_T_C,chr2_218305802_G_A,chr2_218305654_A_G,chr2_218304849_T_C,chr2_218303709_G_A,chr2_218303242_C_T,chr2_218302840_G_C,chr2_218302806_G_A,chr2_218300004_G_A,chr2_218299570_A_G,chr2_218298113_C_T,chr2_218296518_C_T,chr2_218296141_C_A,chr2_218296026_T_C,chr2_218295898_T_C,chr2_218295047_G_A,chr2_218294906_T_C,chr2_218293236_T_C,chr2_218292969_C_T,chr2_218292256_G_A,chr2_218291186_G_T,chr2_218291184_A_T,chr2_218288214_G_T,chr2_218287203_T_C,chr2_218287044_C_T,chr2_218286495_A_C,chr2_218285584_A_G,chr2_218285515_A_G,chr2_218285488_A_G,chr2_218285017_G_A,chr2_218284916_C_T,chr2_218284440_A_G,chr2_218283646_G_A,chr2_218282522_T_G,chr2_218282159_G_C,chr2_218282145_T_C,chr2_218282080_G_A,chr2_218281884_T_C,chr2_218281476_T_A,chr2_218279843_AAG_A,chr2_218279775_A_G,chr2_218279531_G_A,chr2_218279507_A_T,chr2_218279426_G_A,chr2_218279366_G_A,chr2_218278604_T_C,chr2_218278506_G_A,chr2_218278050_C_T,chr2_218277871_C_T,chr2_218277768_C_T,chr2_218276735_C_G,chr2_218276641_A_AC,chr2_218275565_G_C,chr2_218274217_C_T,chr2_218273902_A_G,chr2_218272165_TAA_T,chr2_218270227_C_T,chr2_218270205_A_G,chr2_218268414_A_G,chr2_218268008_G_A,chr2_218261086_C_T,chr2_218260198_T_A,chr2_218259499_G_A,chr2_218258058_G_T,chr2_218258057_A_T,chr2_218257367_G_A,chr2_218256940_G_A,chr2_218256805_A_G,chr2_218255865_A_G,chr2_218255532_C_T,chr2_218254395_AGAAG_A,chr2_218250385_C_T,chr2_218248563_C_T,chr2_218245902_G_A,chr2_218244310_A_G,chr2_218244190_C_A,chr2_218240267_T_C,chr2_218240104_G_A,chr2_218240002_T_A,chr2_218236146_C_G,chr2_218235937_GA_G,chr2_218235479_C_T,chr2_218233673_G_GT,chr2_218233015_G_A,chr2_218230831_G_A,chr2_218229211_G_A,chr2_218228276_G_A,chr2_218226523_G_A,chr2_218224408_A_T,chr2_218222349_A_T,chr2_218221140_G_C,chr2_218218595_G_T,chr2_218216255_G_A,chr2_218215995_G_A,chr2_218214790_G_A,chr2_218211490_G_C,chr2_218209081_A_G,chr2_218209056_T_C,chr2_218209022_A_G,chr2_218208295_C_T,chr2_218203380_C_T,chr2_218201795_T_C,chr2_218199668_T_A,chr2_218191657_G_A,chr2_218189714_AG_A,chr2_218188418_G_T,chr2_218187823_G_A,chr2_218053734_G_T,chr9_132991261_C_G,chr9_132990767_C_T,chr9_132990109_T_C,chr9_132988790_C_T')


# input_file=$(echo "$output_dir""GTEx_sQTLs.tsv")



# # # --dependency=afterany:$myjobid_get_vcf

# myjobid_run_LDlinkR=$(sbatch --dependency=afterany:$myjobid_get_vcf --job-name=$name_run_LDlinkR --output=$outfile_run_LDlinkR --partition=cpuq --time=24:00:00 --nodes=1 --ntasks-per-node=1 --mem-per-cpu=4096M --parsable --wrap="Rscript $Rscript_run_LDlinkR --input_file $input_file --VAR_array $VAR_array --type $type --out $output_dir")
# myjobid_seff_run_LDlinkR=$(sbatch --dependency=afterany:$myjobid_run_LDlinkR --open-mode=append --output=$outfile_run_LDlinkR --job-name=$seff_name --partition=cpuq --time=24:00:00 --nodes=1 --ntasks-per-node=1 --mem-per-cpu=128M --parsable --wrap="seff $myjobid_run_LDlinkR >> $outfile_run_LDlinkR")

# conda deactivate



#### Collect_LDlinkR_results #############################


type=$(echo "Collect_LDlinkR_results")
outfile_Collect_LDlinkR_results=$(echo "$Log_files""outfile_3_""$type"".log")
touch $outfile_Collect_LDlinkR_results
echo -n "" > $outfile_Collect_LDlinkR_results
name_Collect_LDlinkR_results=$(echo "$type""_job")
seff_name=$(echo "seff""_""$type")

Rscript_Collect_LDlinkR_results=$(echo "$Rscripts_path""234_Gather_variants_from_LDlinkR.R")

input_file=$(echo "$output_dir""GTEx_sQTLs.tsv")
LD_thresholds=$(echo '0.5,0.7,0.9')

# --dependency=afterany:$myjobid_run_LDlinkR

myjobid_Collect_LDlinkR_results=$(sbatch --job-name=$name_Collect_LDlinkR_results --output=$outfile_Collect_LDlinkR_results --partition=cpuq --time=24:00:00 --nodes=1 --ntasks-per-node=1 --mem-per-cpu=4096M --parsable --wrap="Rscript $Rscript_Collect_LDlinkR_results --input_file $input_file --LD_thresholds $LD_thresholds  --type $type --out $output_dir")
myjobid_seff_Collect_LDlinkR_results=$(sbatch --dependency=afterany:$myjobid_Collect_LDlinkR_results --open-mode=append --output=$outfile_Collect_LDlinkR_results --job-name=$seff_name --partition=cpuq --time=24:00:00 --nodes=1 --ntasks-per-node=1 --mem-per-cpu=128M --parsable --wrap="seff $myjobid_Collect_LDlinkR_results >> $outfile_Collect_LDlinkR_results")

exit
